(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["copartner/joinPartner/index"],{4178:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a}));var a={uniPopup:function(){return Promise.all([n.e("common/vendor"),n.e("components/uni-popup/uni-popup")]).then(n.bind(null,"1c89"))}},o=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.agreementFlag=!e.agreementFlag},e.e1=function(t){e.agreementFlag=!e.agreementFlag},e.e2=function(t,n){var a=arguments[arguments.length-1].currentTarget.dataset,o=a.eventParams||a["event-params"];n=o.item;e.params.distributorTypeId=n.id,e.partnerName=n.name,e.distributorAgreement()},e.e3=function(t){e.params.licenseImage=""})},r=[]},"76fa":function(e,t,n){},"7e24":function(e,t,n){"use strict";var a=n("76fa"),o=n.n(a);o.a},a644:function(e,t,n){"use strict";(function(e){n("6cdc");a(n("66fd"));var t=a(n("b94d"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},b94d:function(e,t,n){"use strict";n.r(t);var a=n("4178"),o=n("c0a2");for(var r in o)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(r);n("7e24");var i,s=n("f0c5"),u=Object(s["a"])(o["default"],a["b"],a["c"],!1,null,"51c061a0",null,!1,a["a"],i);t["default"]=u.exports},c0a2:function(e,t,n){"use strict";n.r(t);var a=n("c55d"),o=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(r);t["default"]=o.a},c55d:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s(n("a34a")),o=(s(n("5315")),s(n("92c6"))),r=s(n("ee48")),i=s(n("e6bc"));function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t,n,a,o,r,i){try{var s=e[r](i),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(a,o)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(a,o){var r=e.apply(t,n);function i(e){u(r,a,o,i,s,"next",e)}function s(e){u(r,a,o,i,s,"throw",e)}i(void 0)}))}}var d=function(){n.e("copartner/joinPartner/agreementPopup").then(function(){return resolve(n("304c8"))}.bind(null,n)).catch(n.oe)},p=function(){n.e("copartner/joinPartner/selectAddress").then(function(){return resolve(n("4dcf"))}.bind(null,n)).catch(n.oe)},f={mixins:[r.default],data:function(){return{defaultTitleDto:{title:"加入合伙人"},countdown:{inter:"",count:0},partnerName:"",partnerConfig:[],params:{realName:"",mobile:"",captcha:"",inviteCode:"",licenseImage:"",distributorTypeId:"",districtId:""},addressParams:{},agreementFlag:!0,agreementInfo:[],imgBaseUrls:this.$config.imgBaseUrl}},onShow:function(){},methods:{distributorAgreement:function(){var e=this;o.default.distributorAgreement(this.params.distributorTypeId).then((function(t){t.data.code&&(e.agreementInfo=t.data.data)}))},openPopup:function(){this.$refs.openPopup.openPopup()},captcha:function(){var t=this;if(!e.getStorageSync("sessionId"))return e.showToast({title:"请登录",icon:"none"}),void setTimeout((function(){t.$Router.push({path:"/pages/login/index"})}),1e3);/^\d{11}$/.test(this.params.mobile)?(this.countDownTime(),this.sendCaptcha()):e.showToast({title:"请输入正确的手机号",icon:"none"})},countDownTime:function(){var e=this;this.countdown.count=60,this.countdown.inter=setInterval((function(){e.countdown.count--,e.countdown.count||clearInterval(e.countdown.inter)}),1e3)},chooseimage:function(){var t=this;e.chooseImage({count:1,success:function(e){t.uploadImage(e.tempFiles[0].path,t.params.licenseImage)}})},updateImage:function(e,t){this.$set(this.params,"licenseImage",e.data)},sendCaptcha:function(){o.default.sendCaptcha(this.params.mobile).then((function(t){200==t.data.code?e.showToast({title:"发送成功",icon:"none"}):e.showToast({title:t.data.message,icon:"none"})}))},submit:function(){var t=this;if(this.agreementFlag){for(var n in this.params)if(!this.params[n]&&"licenseImage"!=n)return void e.showToast({title:"请检查必填项是否填写完整",icon:"none"});o.default.submitDistributor(this.params).then((function(n){200==n.data.code?(e.showToast({title:"提交成功，等待审核",icon:"none"}),setTimeout((function(){"客户"==t.partnerName?t.$Router.push({path:"/pages/giftCardList/index"}):e.switchTab({url:"/pages/my/index"})}),1e3)):e.showToast({title:n.data.message,icon:"none"})}))}else e.showToast({title:"请先同意文器库平台协议",icon:"none"})},closeAddPopup:function(){this.$refs.addressPopup.close()},addressChange:function(e){for(var t in e)this.$set(this.addressParams,t,e[t]);this.params.districtId=e.districtId,this.$refs.addressPopup.close()},openAddress:function(){this.$refs.addressPopup.open()}},onLoad:function(t){var n=this;return c(a.default.mark((function o(){return a.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:try{n.$Route.query.scene&&(n.params.inviteCode=decodeURIComponent(n.$Route.query.scene).split(",")[0],e.setStorageSync("routerShareNumber",n.params.inviteCode)),t&&t.scene&&(n.params.inviteCode=decodeURIComponent(t.scene).split(",")[0],n.params.inviteCode&&e.setStorageSync("routerShareNumber",n.params.inviteCode)),t&&t.shareNumber&&(n.params.inviteCode=t.shareNumber,e.setStorageSync("routerShareNumber",n.params.inviteCode)),n.$Route.query.shareNumber&&(n.params.inviteCode=n.$Route.query.shareNumber,e.setStorageSync("routerShareNumber",n.params.inviteCode))}catch(o){}return a.next=3,i.default.getPartner();case 3:n.partnerConfig=a.sent,n.params.distributorTypeId=n.partnerConfig[0].id,n.partnerName=n.partnerConfig[0].name,n.distributorAgreement(),e.getStorageSync("sessionId")||(e.showToast({title:"请登录",icon:"none"}),setTimeout((function(){n.$Router.push({path:"/pages/login/index"})}),1e3));case 8:case"end":return a.stop()}}),o)})))()},components:{agreementPopup:d,selectAddress:p}};t.default=f}).call(this,n("543d")["default"])}},[["a644","common/runtime","common/vendor"]]]);