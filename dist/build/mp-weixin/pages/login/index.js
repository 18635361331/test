(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/index"],{1799:function(e,t,o){"use strict";(function(e){o("6cdc");n(o("66fd"));var t=n(o("efcf"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,o("543d")["createPage"])},"3d33":function(e,t,o){"use strict";o.r(t);var n=o("81f7"),a=o.n(n);for(var i in n)["default"].indexOf(i)<0&&function(e){o.d(t,e,(function(){return n[e]}))}(i);t["default"]=a.a},"44d1":function(e,t,o){"use strict";var n;o.d(t,"b",(function(){return a})),o.d(t,"c",(function(){return i})),o.d(t,"a",(function(){return n}));var a=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.chooseType="quick"},e.e1=function(t){e.chooseType="pass"},e.e2=function(t){e.passwordFlag=!e.passwordFlag},e.e3=function(t){e.passwordFlag=!e.passwordFlag},e.e4=function(t){!e.telephone&&e.otherLogin()})},i=[]},"4e1d":function(e,t,o){},"81f7":function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=c(o("5315")),a=c(o("081b")),i=c(o("6b82"));function c(e){return e&&e.__esModule?e:{default:e}}var s=function(){Promise.all([o.e("common/vendor"),o.e("pages/login/agreementPopup")]).then(function(){return resolve(o("e2d5"))}.bind(null,o)).catch(o.oe)},u=function(){o.e("common/model/wxLogin/index").then(function(){return resolve(o("3095"))}.bind(null,o)).catch(o.oe)},d={mixins:[i.default],data:function(){return{passwordFlag:!1,chooseType:"quick",quick:{telephone:"",captcha:""},account:{loginName:"",password:""},countdown:{inter:"",count:0},authorizeFlag:!0,telephone:"",retry:1}},methods:{judgeSubmit:function(){"quick"==this.chooseType?this.quickLogin():this.accountLogin()},captcha:function(){/^\d{11}$/.test(this.quick.telephone)?(this.countDownTime(),n.default.captcha({telephone:this.quick.telephone,type:"0"}).then((function(t){200==t.data.code||e.showToast({title:t.data.message,icon:"none"})}))):e.showToast({title:"请输入正确的手机号",icon:"none"})},countDownTime:function(){var e=this;this.countdown.count=60,this.countdown.inter=setInterval((function(){e.countdown.count--,e.countdown.count||clearInterval(e.countdown.inter)}),1e3)},accountLogin:function(){var t=this;this.account.loginName?this.account.password?n.default.accountLogin({loginName:this.account.loginName,password:this.account.password,inviteCode:e.getStorageSync("routerShareNumber")?e.getStorageSync("routerShareNumber"):"",inviteType:""}).then((function(o){200==o.data.code?(t.zhuge.identify(o.data.data.telephone),t.loginStore(o.data.data),t.judgeLoginType(o)):e.showToast({title:o.data.message,icon:"none"})})):e.showToast({title:"请输入密码",icon:"none"}):e.showToast({title:"请输入账号或手机号",icon:"none"})},wechatH5Login:function(t){var o=this;n.default.wechatH5Login(t).then((function(t){200==t.data.code?(o.loginStore(t.data.data),o.judgeLoginType(t)):e.showToast({title:t.data.message,icon:"none"})}))},judgeLoginType:function(t){t.data.data.hasBindTel?t.data.data.needResetPwd?this.$Router.push({path:"/pages/modifyPwdForLogin/index",query:{loginName:t.data.data.userName,telephone:t.data.data.telephone,resetPwdCode:t.data.data.resetPwdCode,isLogin:!0}}):t.data.data.needVerifyTel?this.$Router.push({path:"/pages/modifyPwdForLogin/index",query:{loginName:t.data.data.userName,telephone:t.data.data.telephone,resetPwdCode:t.data.data.resetPwdCode,verifyTel:!0,isLogin:!0}}):(e.showToast({title:"登录成功",icon:"none"}),this.goBack(1)):this.$Router.push({path:"/pages/phoneCheck/index",query:{loginName:t.data.data.userName,operateCode:t.data.data.bindTelCode,isLogin:!0}})},quickLogin:function(){var t=this;/^\d{11}$/.test(this.quick.telephone)?/^\d{6}$/.test(this.quick.captcha)?(console.log(11111111),console.log(e.getStorageSync("routerShareNumber")),n.default.quickLogin({telephone:this.quick.telephone,captcha:this.quick.captcha,inviteCode:e.getStorageSync("routerShareNumber")?e.getStorageSync("routerShareNumber"):"",inviteType:e.getStorageSync("routerShareNumber")?1:""}).then((function(o){200==o.data.code?(t.zhuge.identify(t.quick.telephone),t.loginStore(o.data.data),o.data.data.hasSetPwd?o.data.data.needResetPwd?t.$Router.push({path:"/pages/modifyPwdForLogin/index",query:{loginName:o.data.data.userName,telephone:o.data.data.telephone,resetPwdCode:o.data.data.resetPwdCode,isLogin:!0}}):(e.showToast({title:"登录成功",icon:"none"}),t.goBack(1)):t.$Router.push({path:"/pages/registerSetPassword/index",query:{telephone:t.quick.telephone,operateCode:o.data.data.setPwdCode}})):e.showToast({title:o.data.message,icon:"none"})}))):e.showToast({title:"验证码输入有误",icon:"none"}):e.showToast({title:"请输入正确的手机号",icon:"none"})},otherLogin:function(){this.$Router.push({path:"/pages/authorization/index"})},getUserInfo:function(t){var o=this;e.login({success:function(n){var a={encryptedData:t.encryptedData,iv:t.iv,code:n.code,telephone:e.getStorageSync("userInfoTelphone"),inviteCode:e.getStorageSync("routerShareNumber")?e.getStorageSync("routerShareNumber"):""};o.wechatMiniAuth(a)}})},h5UniLogin:function(){a.default.wxPubAppId().then((function(t){if(200==t.data.code){var o="https://"+location.host+location.pathname;location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+t.data.data+"&redirect_uri="+encodeURIComponent(o)+"&response_type=code&scope=snsapi_userinfo"}else e.showToast({title:t.data.message,icon:"none"})}))},wechatMiniAuth:function(t){var o=this;n.default.wechatMiniAuth(t).then((function(n){if(e.hideLoading(),200==n.data.code)o.zhuge.identify(n.data.data.telephone),o.loginStore(n.data.data),o.judgeLoginType(n);else{if(o.retry>3)return void e.showToast({title:n.data.message,icon:"none"});o.retry++,o.getUserInfo(t)}}))},getSetting:function(){var t=this;e.getSetting({success:function(e){e.authSetting["scope.userInfo"]?t.authorizeFlag=!0:t.authorizeFlag=!1}})},goToForgetPwd:function(){this.$Router.push({path:"/pages/forgetPassword/index"})},openPopup:function(){this.$refs.agreementPopup.openPopup()},loginStore:function(t){e.setStorageSync("sessionId",t.sessionId),e.setStorageSync("shareNumber",t.shareNumber),e.setStorageSync("userInfo",JSON.stringify(t))}},onLoad:function(t){t.code&&!e.getStorageSync("hasCode")&&(e.setStorageSync("hasCode",!0),this.wechatH5Login(t.code))},onShow:function(){this.telephone=e.getStorageSync("userInfoTelphone"),this.zhuge.track("登录页面"),this.getSetting(),this.fmagentInit()},components:{agreementPopup:s,wxLogin:u}};t.default=d}).call(this,o("543d")["default"])},efcf:function(e,t,o){"use strict";o.r(t);var n=o("44d1"),a=o("3d33");for(var i in a)["default"].indexOf(i)<0&&function(e){o.d(t,e,(function(){return a[e]}))}(i);o("f47f");var c,s=o("f0c5"),u=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],c);t["default"]=u.exports},f47f:function(e,t,o){"use strict";var n=o("4e1d"),a=o.n(n);a.a}},[["1799","common/runtime","common/vendor"]]]);