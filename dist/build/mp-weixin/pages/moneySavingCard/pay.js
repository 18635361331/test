(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/moneySavingCard/pay"],{"282d":function(e,t,n){"use strict";(function(e){n("6cdc");a(n("66fd"));var t=a(n("2bdc"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},"2bdc":function(e,t,n){"use strict";n.r(t);var a=n("d7b6"),i=n("d038");for(var o in i)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(o);n("9cd1");var r,c=n("f0c5"),d=Object(c["a"])(i["default"],a["b"],a["c"],!1,null,"b794b6cc",null,!1,a["a"],r);t["default"]=d.exports},"9cd1":function(e,t,n){"use strict";var a=n("ffcb"),i=n.n(a);i.a},d038:function(e,t,n){"use strict";n.r(t);var a=n("d286"),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=i.a},d286:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n("2c57")),i=o(n("081b"));function o(e){return e&&e.__esModule?e:{default:e}}var r={data:function(){return{payInfo:{orderPayId:1,orderType:"cycle"},payPrice:"",chooseType:"微信",isWxFlag:!0,defaultTitleDto:{title:"收银台"},wxCode:""}},methods:{chooseChange:function(e){this.chooseType=e},buyNow:function(){var t=this;e.login({success:function(e){t.buildMiniPrepPaySign(e.code)}})},getH5Code:function(){var t=this;i.default.wxPubAppId().then((function(n){if(200==n.data.code){var a="?orderPayId="+t.$Route.query.orderPayId+"&payPrice="+t.$Route.query.payPrice+"&goodsId="+t.$Route.query.goodsId,i="https://"+location.host+location.pathname+a;location.href=location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+n.data.data+"&redirect_uri="+encodeURIComponent(i)+"&response_type=code&scope=snsapi_userinfo"}else e.showToast({title:n.data.message,icon:"none"})}))},buildPrepPaySign:function(){var t=this;a.default.buildPrepPaySign({code:this.wxCode,orderPayId:this.$Route.query.orderPayId,orderType:"cycle"}).then((function(n){200==n.data.code?t.requestH5Payment(n.data.data):e.showToast({title:n.data.message,icon:"none"})}))},requestH5Payment:function(e){"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",this.WeixinJSBridgeH5,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",this.WeixinJSBridgeH5),document.attachEvent("onWeixinJSBridgeReady",this.WeixinJSBridgeH5)):this.WeixinJSBridgeH5(e)},WeixinJSBridgeH5:function(e){var t=this;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e.appId,timeStamp:e.timeStamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:e.paySign},(function(e){"get_brand_wcpay_request:ok"==e.err_msg?t.payCallBack(!0):(e.err_msg,t.payCallBack(!1))}))},buildMiniPrepPaySign:function(t){var n=this;a.default.buildMiniPrepPaySign({code:t,orderPayId:this.$Route.query.orderPayId,orderType:"cycle"}).then((function(t){200==t.data.code?n.requestpayment(t.data.data):e.showToast({title:t.data.message,icon:"none"})}))},requestpayment:function(t){var n=this;e.requestPayment({provider:"payment",timeStamp:t.timeStamp,nonceStr:t.nonceStr,package:t.package,paySign:t.paySign,signType:t.signType,success:function(e){n.payCallBack(!0)},fail:function(e){n.payCallBack(!1)}})},payCallBack:function(t){t?(e.showToast({title:"支付成功",icon:"none"}),this.$Router.replace({path:"/pages/payment/index",query:{source:1,payId:this.$Route.query.orderPayId}})):e.showToast({title:"用户已取消支付",icon:"none"})},closeAuthorize:function(){this.$refs.authorize.close()}},mounted:function(){this.payPrice=this.$Route.query.payPrice},onLoad:function(e){}};t.default=r}).call(this,n("543d")["default"])},d7b6:function(e,t,n){"use strict";var a;n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var i=function(){var e=this,t=e.$createElement;e._self._c},o=[]},ffcb:function(e,t,n){}},[["282d","common/runtime","common/vendor"]]]);