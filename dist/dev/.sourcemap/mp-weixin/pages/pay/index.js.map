{"version":3,"sources":["uni-app:///src/main.js","webpack:///./src/pages/pay/index.vue?1844","webpack:///./src/pages/pay/index.vue?06da","webpack:///./src/pages/pay/index.vue?fd7a","webpack:///./src/pages/pay/index.vue?eee1","uni-app:///src/pages/pay/index.vue","webpack:///./src/pages/pay/index.vue?57e4","webpack:///./src/pages/pay/index.vue?b29b"],"names":["createPage","Page"],"mappings":"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A;AASA,0CATA,CASA;;;AACA;AACA;AACA;;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAaA,KAhIA;AAiIA,wBAjIA,gCAiIA,IAjIA,EAiIA;AAAA;AACA;;AACA;AAAA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AACA,KA1IA;AA2IA,oBA3IA,4BA2IA,MA3IA,EA2IA;AAAA;AACA,6BADA,CAEA;;AACA;;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;;AACA,8BATA,CAUA;;AACA;AACA,KAvJA;AAwJA,wBAxJA,gCAwJA,IAxJA,EAwJA;AAAA;AACA;AACA;AACA,OAFA;AAGA;AACA,KA7JA;AA8JA,oBA9JA,8BA8JA;AAAA;AACA,0BADA,CACA;;AACA;AAAA;AACA;AACA;;AAMA;AACA,KAzKA;AA0KA,gBA1KA,0BA0KA;AAAA;AACA;;AACA,6HACA,MADA,KACA,IADA,EACA;AACA;;AACA;AACA;AACA,SAFA,MAEA,6IACA,cADA,EACA;AACA,+JACA,wCADA,EACA;AACA;AACA,WAHA,MAGA;AACA;AACA;AACA,aAFA,MAEA;AACA;AACA;AACA;AACA,SAZA,MAYA;AACA;AACA;AACA,WAFA,MAEA;AACA;AACA;AACA;AACA,OAxBA,MAwBA;AACA;AAEA;AACA,iBADA,mBACA,IADA,EACA;AACA;AACA;AAHA;AAKA;AAMA;AACA,KAnNA;AAoNA,wBApNA,gCAoNA,IApNA,EAoNA,KApNA,EAoNA;AAAA;;AAAA;AACA;;AACA;AAAA;AACA;AACA,OAFA,MAEA;AAAA;AACA;AACA;;AACA;AACA,kBADA;AAEA,2DAFA;AAGA;AAHA,SAIA,IAJA,CAIA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA,mCADA;AAEA;AAFA;AAIA;AACA,OAbA;AAcA,KAzOA;AA0OA,oBA1OA,8BA0OA;AAAA;;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA,mCADA;AAEA;AAFA;AAIA;AACA,OATA;AAUA,KArPA;AAsPA,kBAtPA,0BAsPA,MAtPA,EAsPA;AAAA;AACA;;AACA;AACA,2BADA;AAEA,mCAFA;AAGA,iCAHA;AAIA,+BAJA;AAKA,+BALA;AAMA,iCANA;AAOA;AACA;AACA,SATA;AAUA;AACA;AAEA;AAbA;AAeA,KAvQA;AAwQA,oBAxQA,4BAwQA,MAxQA,EAwQA;AAAA;AACA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AACA,OAPA,MAOA;AACA;AACA;AACA,KAnRA;AAoRA,oBApRA,4BAoRA,MApRA,EAoRA;AACA;;AACA,4BACA,sBADA,EACA;AACA,6BADA;AACA;AACA,qCAFA;AAEA;AACA,mCAHA;AAGA;AACA,iCAJA;AAKA,mCALA;AAKA;AACA,iCANA,CAMA;;AANA,OADA,EASA;AACA;AACA;AACA,SAFA,MAEA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA,OAjBA;AAmBA,KAzSA;AA0SA,eA1SA,uBA0SA,IA1SA,EA0SA;AAAA;;AAAA;AACA;AACA;AACA,uBADA;AAEA;AAFA;AAIA;AACA,sCADA;AAEA;AACA,0CADA;AAEA,8CAFA;AAGA;AAHA;AAFA;AAQA,OAbA,MAaA;AACA;AACA,gCADA;AAEA;AAFA;AAIA;AACA;AACA;AADA;AAGA,SAJA,EAIA,GAJA;AAKA;AACA,KAnUA;AAoUA,aApUA,uBAoUA;AAAA;;AAAA;AACA;AACA;AACA;AACA;AACA,SAHA,MAGA;AACA;AACA,mCADA;AAEA;AAFA;AAIA;AACA,OAVA;AAWA,KAhVA;AAiVA,mBAjVA,6BAiVA;AAAA;AACA;AACA,KAnVA;AAoVA,gBApVA,wBAoVA,QApVA,EAoVA;AAAA;AACA;AACA;AACA,KAvVA;AAwVA,cAxVA,sBAwVA,IAxVA,EAwVA;AAAA;AACA;AACA;AACA,KA3VA;AA4VA,UA5VA,oBA4VA;AAAA;;AAAA;AACA;AACA,wGADA;AAEA,4CAFA;AAGA,sCAHA;AAIA,yDAJA;AAKA,4DALA;AAMA,sFANA;AAOA,oCAPA;AAQA;AARA;;AAUA;AACA;AACA;;AACA;AACA;AACA,+BADA;AAEA;AAFA;AAIA;AACA;AACA;AACA;AAHA;AAKA;AACA;;AACA;AACA,SAfA,MAeA;AACA;AACA,mCADA;AAEA;AAFA;AAIA;AACA,OAtBA;AAuBA,KA9XA;AAgYA,qBAhYA,+BAgYA;AAAA;AACA;AACA;AACA;AACA;AApYA,GA7BA;AAmaA,QAnaA,kBAmaA,MAnaA,EAmaA;AASA;AAEA;AACA;AAEA;AACA;;AACA;AACA;AACA;AACA;AACA,GAvbA;AAwbA,QAxbA,oBAwbA;AACA;AACA,GA1bA;AA2bA;AACA,wBADA;AAEA,8BAFA;AAGA,sBAHA;AAIA,sCAJA;AAKA;AALA;AA3bA,C;;;;;;;;;;;;;;AC5JA;AAAA;AAAA;AAAA;AAAyuB,CAAgB,2uBAAG,EAAC,C;;;;;;;;;;;ACA7vB;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/pay/index.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/pay/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=32f2f1fc&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=32f2f1fc&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"32f2f1fc\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/pay/index.vue\"\nexport default component.exports","export * from \"-!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--14-0!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=32f2f1fc&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = !_vm.payInfo.payedSummary\n    ? _vm.chooseTypeList.indexOf(\"账户余额\")\n    : null\n  var g1 = !_vm.payInfo.payedSummary\n    ? _vm.chooseTypeList.indexOf(\"账户余额\")\n    : null\n  var g2 =\n    _vm.payInfo.memberAsset && !_vm.payInfo.payedSummary\n      ? _vm.chooseTypeList.indexOf(\"礼卡\")\n      : null\n  var g3 =\n    _vm.payInfo.memberAsset &&\n    !_vm.payInfo.payedSummary &&\n    !this.payInfo.payedSummary\n      ? _vm.chooseTypeList.indexOf(\"礼卡\")\n      : null\n  var g4 = _vm.isWxFlag ? _vm.chooseTypeList.indexOf(\"微信\") : null\n  var g5 =\n    _vm.isWxFlag && g4 != \"-1\" ? Number(_vm.surplusMoney).toFixed(2) : null\n  var g6 = _vm.isWxFlag ? _vm.chooseTypeList.indexOf(\"微信\") : null\n\n  if (!_vm._isMounted) {\n    _vm.e0 = function($event) {\n      _vm.payFlag = !_vm.payFlag\n    }\n  }\n\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        g2: g2,\n        g3: g3,\n        g4: g4,\n        g5: g5,\n        g6: g6\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"page commonPageTitle\">\r\n\t\t<defaultTitle :dto=\"defaultTitleDto\"></defaultTitle>\r\n\t\t<view class=\"orderPrice\">\r\n\t\t\t应付\r\n\t\t\t<text class=\"orderAmount\" v-if=\"payInfo.payedSummary\">￥{{surplusMoney?surplusMoney:\"\"}}</text>\r\n\t\t\t<text class=\"orderAmount\" v-else>￥{{payInfo.orderAmount?payInfo.orderAmount:\"\"}}</text>\r\n\t\t\t<view class=\"orderDetailsBtn\" @click=\"payFlag=!payFlag\">\r\n\t\t\t\t{{payFlag?\"收起\":\"详情\"}}\r\n\t\t\t\t<text :class=\"payFlag?'active':''\"></text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"orderPriceMain\" v-if=\"payFlag\">\r\n\t\t\t<view class=\"everyRow\">\r\n\t\t\t\t<text>商品金额</text>\r\n\t\t\t\t<text>￥{{payInfo.orderSummary.goodsAmount}}</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"everyRow\">\r\n\t\t\t\t<text>运费</text>\r\n\t\t\t\t<text>￥{{payInfo.orderSummary.freightAmount}}</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"everyRow\">\r\n\t\t\t\t<text>库豆抵扣</text>\r\n\t\t\t\t<text>-￥{{payInfo.orderSummary.goldAmount}}</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"everyRow\">\r\n\t\t\t\t<text>积分抵扣</text>\r\n\t\t\t\t<text>-￥{{payInfo.orderSummary.scorePayedAmount}}</text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"myWalletHead\">\r\n\t\t\t文器库商城支付\r\n\t\t</view>\r\n\t\t<view class=\"myWalletInfo\" v-if=\"!payInfo.payedSummary\">\r\n\t\t\t<view class=\"mask\" v-if=\"payInfo.memberAsset && payInfo.memberAsset.balance<=0\"></view>\r\n\t\t\t<view class=\"walletIcon\"></view>\r\n\t\t\t<view class=\"walletText\">\r\n\t\t\t\t<view class=\"walletType\">\r\n\t\t\t\t\t账户余额\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"walletPrice\">\r\n\t\t\t\t\t余额￥{{payInfo.memberAsset?payInfo.memberAsset.accountBalance:0}} 可用￥{{payInfo.memberAsset.balance?payInfo.memberAsset.balance:0}}\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"payPrice\" v-if=\"chooseTypeList.indexOf('账户余额')!='-1'\">\r\n\t\t\t\t￥{{payInfo.memberAsset.balanceUseMoney}}\r\n\t\t\t</view>\r\n\t\t\t<view class=\"payChooseBtn\" @click.stop=\"accountChange()\" :class=\"chooseTypeList.indexOf('账户余额')!='-1'?'active':''\"></view>\r\n\t\t</view>\r\n\t\t<!-- 余额支付后进行站外支付展示信息 -->\r\n\t\t<view class=\"myWalletInfo\" v-if=\"payInfo.payedSummary && payInfo.payedSummary.balanceAmount\">\r\n\t\t\t<view class=\"walletIcon\"></view>\r\n\t\t\t<view class=\"walletText\">\r\n\t\t\t\t<view class=\"walletType\">\r\n\t\t\t\t\t账户余额\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"payPrice\">\r\n\t\t\t\t￥{{payInfo.payedSummary.balanceAmount?payInfo.payedSummary.balanceAmount:0}}\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"myWalletInfo\" @click=\"openGiftCardPopup\" v-if=\"payInfo.memberAsset && !payInfo.payedSummary\">\r\n\t\t\t<view class=\"mask\" v-if=\"payInfo.memberAsset.cardAmount<=0\"></view>\r\n\t\t\t<view class=\"walletIcon icon_m\"></view>\r\n\t\t\t<view class=\"walletText\">\r\n\t\t\t\t<view class=\"walletType\">\r\n\t\t\t\t\t礼卡\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"walletPrice\">\r\n\t\t\t\t\t余额￥{{payInfo.memberAsset.accountCard}} 可用￥{{payInfo.memberAsset.cardAmount}}\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"payPrice\" v-if=\"chooseTypeList.indexOf('礼卡')!='-1'\">\r\n\t\t\t\t￥{{payInfo.memberAsset.cardUseMoney}}\r\n\t\t\t</view>\r\n\t\t\t<view v-if=\"!this.payInfo.payedSummary\" class=\"payChooseBtn\" @click.stop=\"giftChange\" :class=\"chooseTypeList.indexOf('礼卡')!='-1'?'active':''\"></view>\r\n\t\t</view>\r\n\t\t<view class=\"myWalletInfo\" @click=\"openGiftCardPopup\" v-if=\"payInfo.payedSummary && payInfo.payedSummary.cardAmount\">\r\n\t\t\t<view class=\"walletIcon icon_m\"></view>\r\n\t\t\t<view class=\"walletText\">\r\n\t\t\t\t<view class=\"walletType\">\r\n\t\t\t\t\t礼卡\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"payPrice\">\r\n\t\t\t\t-￥{{payInfo.payedSummary.cardAmount}}\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"myWalletHead\">\r\n\t\t\t其它方式支付\r\n\t\t</view>\r\n\t\t<!-- #ifndef MP-WEIXIN -->\r\n\t\t<view class=\"payType\" v-if=\"!isWxFlag\">\r\n\t\t\t<view class=\"mask\" v-if=\"surplusMoney<=0\"></view>\r\n\t\t\t<view class=\"alipayIcon\"></view>\r\n\t\t\t<view class=\"payText\">\r\n\t\t\t\t支付宝支付\r\n\t\t\t</view>\r\n\t\t\t<view class=\"payPrice\" v-if=\"chooseTypeList.indexOf('支付宝')!='-1'\">\r\n\t\t\t\t￥{{Number(surplusMoney).toFixed(2)}}\r\n\t\t\t</view>\r\n\t\t\t<view class=\"payChooseBtn\" @click=\"outsideStationChange('支付宝')\" :class=\"chooseTypeList.indexOf('支付宝')!='-1'?'active':''\"></view>\r\n\t\t</view>\r\n\t\t<!-- #endif -->\r\n\t\t<view class=\"payType\" v-if=\"isWxFlag\">\r\n\t\t\t<view class=\"mask\" v-if=\"surplusMoney<=0\"></view>\r\n\t\t\t<view class=\"weixinIcon\"></view>\r\n\t\t\t<view class=\"payText\">\r\n\t\t\t\t微信\r\n\t\t\t</view>\r\n\t\t\t<view class=\"payPrice\" v-if=\"chooseTypeList.indexOf('微信')!='-1'\">\r\n\t\t\t\t￥{{Number(surplusMoney).toFixed(2)}}\r\n\t\t\t</view>\r\n\t\t\t<view class=\"payChooseBtn\" @click=\"outsideStationChange('微信')\" :class=\"chooseTypeList.indexOf('微信')!='-1'?'active':''\"></view>\r\n\t\t</view>\r\n\t\t<view class=\"surePayBtn\" @click=\"openPswPopup\" v-if=\"payInfo.payedSummary\">\r\n\t\t\t{{chooseTypeList.length>1?\"组合\":chooseTypeList[0]}}支付￥{{surplusMoney}}元\r\n\t\t</view>\r\n\t\t<view class=\"surePayBtn\" @click=\"openPswPopup\" v-else>\r\n\t\t\t{{chooseTypeList.length>1?\"组合\":chooseTypeList[0]}}支付￥{{payInfo.orderAmount?payInfo.orderAmount:\"\"}}元\r\n\t\t</view>\r\n\t\t<pswPopup ref='pswPopup' @openForgetPopup='openForgetPopup' @submitPay='setSubmitPsw'></pswPopup>\r\n\t\t<setPayPwd ref='setPayPwd' :payInfo='payInfo' @openPswPopup='openPswPopup' @submitPay='setSubmitPsw'></setPayPwd>\r\n\t\t<forgetPayPsw ref='forgetPayPsw' :payInfo='payInfo' @openPswPopup='openPswPopup' @submitPay='setSubmitPsw'></forgetPayPsw>\r\n\t\t<verificationCode ref='verificationCode' :payInfo='payInfo' :isSendSMS='true' @codeSubmit='codeSubmit'></verificationCode>\r\n\t\t<cardList ref='giftCard' :cardInfo='cardInfo' :payInfo='payInfo' @cardAmountChange='cardAmountChange'></cardList>\r\n\t\t<!-- #ifdef MP-WEIXIN -->\r\n\t\t\t<view v-if=\"(hideFMCanvas != undefined) && !hideFMCanvas\">\r\n\t\t\t\t<canvas canvas-id='tdcanvas' style='margin-top:200rpx'></canvas>\r\n\t\t\t</view>\r\n\t\t<!-- #endif  -->\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\t/*\r\n\t\t收银台逻辑\r\n\t\t拿到详情信息去判断是否有余额  如果存在 放入chooseTypeList数组中  并且重新获取礼卡信息 用来判断礼卡是否可用\r\n\t\t调用judgeSurplusMoney判断已选的站内支付金额是否足够支付订单  如果不足 进行判断平台类型（支付宝/微信）\r\n\t\t如果两者都存在 默认勾选微信\r\n\t\t选中按钮以及底部按钮展示文案  按照chooseTypeList的长度以及是否存在该类型来做判断\r\n\t\t\r\n\t\t\r\n\t*/\r\n\timport tradeApi from '@/api/trade/index.js'\r\n\timport payMentApi from '@/api/payment/index.js'\r\n\timport wechatApi from '@/api/wechat/index.js'\r\n\timport setPayPwd from '@/pages/pay/setPayPsw/index.vue'\r\n\timport forgetPayPsw from '@/pages/pay/forgetPayPsw/index.vue'\r\n\timport pswPopup from '@/pages/pay/passwordPopup/index.vue'\r\n\timport verificationCode from '@/pages/pay/verificationCode/index.vue'\r\n\timport cardList from './cardList/index.vue'\r\n\t// #ifdef MP-WEIXIN\r\n\timport fmagent from '@/common/js/fmagent.js'\r\n\t// #endif\r\n\texport default {\r\n\t\t//  #ifdef MP-WEIXIN\r\n\t\tmixins:[fmagent],\r\n\t\t// #endif\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tpayInfo: { //支付详细信息\r\n\t\t\t\t},\r\n\t\t\t\tpayFlag: false, //详情是否展示\r\n\t\t\t\tsubmitParams: { //提交支付\r\n\t\t\t\t\tpayId: \"\",\r\n\t\t\t\t\tscore: 0,\r\n\t\t\t\t\tpassword: \"\",\r\n\t\t\t\t\tthirdPayAmount: 0,\r\n\t\t\t\t\tthirdPayMethod: \"alipay\",\r\n\t\t\t\t\tcardAmount: 0,\r\n\t\t\t\t\tbalance: \"\"\r\n\t\t\t\t},\r\n\t\t\t\tcardInfo: {}, //礼卡相关数据\r\n\t\t\t\tisWxFlag: true, //是否在微信浏览器中  1为小程序   true公众号  false 普通浏览器\r\n\t\t\t\tchooseTypeList: [], //选中的类型列表  当大于一种类型支付时为组合支付  否则为勾选类型支付\r\n\t\t\t\tsurplusMoney: 0, //剩余支付金额\r\n\t\t\t\toldBalance: 0, //账户余额  初始化时记录最大可用账户余额 在礼卡时取消选中时回显是否有可用余额\r\n\t\t\t\twxCode:\"\",\t//公众号code\r\n\t\t\t\tdefaultTitleDto:{\r\n\t\t\t\t\ttitle:'收银台',\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tsummary() { //获取支付详情\r\n\t\t\t\ttradeApi.summary(this.$Route.query.payId).then(res => {\r\n\t\t\t\t\tif (res.data.code == 200) {\r\n\t\t\t\t\t\t// 允许最大使用站内支付金额   如果余额查过限制  将可用余额赋值为最大使用站内余额\r\n\t\t\t\t\t\tif (res.data.data.maxPkgPay < res.data.data.memberAsset.balance) {\r\n\t\t\t\t\t\t\tres.data.data.memberAsset.balance=res.data.data.maxPkgPay\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.oldBalance = res.data.data.memberAsset.balance\r\n\t\t\t\t\t\tthis.payInfo = res.data.data;\r\n\t\t\t\t\t\t// 初始化选中支付类型\r\n\t\t\t\t\t\tthis.initChoose()\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: res.data.message,\r\n\t\t\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tasync initChoose() { //初始化选中支付类型\r\n\t\t\t\t// 第一次进入收银台  没有进行过订单站内的支付\r\n\t\t\t\tif (!this.payInfo.payedSummary) { //没有进行过站内支付 \r\n\t\t\t\t\tif (this.payInfo.memberAsset.balance) {\r\n\t\t\t\t\t\tthis.chooseTypeList.push(\"账户余额\");\r\n\t\t\t\t\t\tthis.$set(this.payInfo.memberAsset, \"balanceUseMoney\", this.payInfo.memberAsset.balance)\r\n\t\t\t\t\t\tawait this.defaultCards() //支付信息变化后用来获取礼卡可用信息及列表\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 如果礼卡可用余额大于0的话 勾选礼卡\r\n\t\t\t\t\tif (this.payInfo.memberAsset.cardAmount) {\r\n\t\t\t\t\t\tthis.chooseTypeList.push(\"礼卡\");\r\n\t\t\t\t\t\tthis.$set(this.payInfo.memberAsset, \"cardUseMoney\", this.payInfo.memberAsset.cardAmount)\r\n\t\t\t\t\t\tawait this.defaultCards();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 如果站内支付不足以支付的话\r\n\t\t\t\t\tthis.judegChooseOther()\r\n\t\t\t\t} else { //已经进行过站内支付   \r\n\t\t\t\t\tthis.surplusMoney = this.payInfo.needPay;\r\n\t\t\t\t\tthis.judegChooseOther();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync defaultCards() { //用户更改支付类型时获取礼卡可用信息\r\n\t\t\t\tlet params = {\r\n\t\t\t\t\tbalance: this.chooseTypeList.indexOf(\"账户余额\") != \"-1\" ? this.payInfo.memberAsset.balanceUseMoney : 0,\r\n\t\t\t\t\tpayId: this.$Route.query.payId,\r\n\t\t\t\t\tcardAmount: this.chooseTypeList.indexOf(\"礼卡\") != \"-1\" ? this.payInfo.memberAsset.cardUseMoney : 0\r\n\t\t\t\t}\r\n\t\t\t\tawait tradeApi.defaultCards(params).then(res => {\r\n\t\t\t\t\tif (res.data.code == 200) {\r\n\t\t\t\t\t\tthis.cardInfo = res.data.data;\r\n\t\t\t\t\t\t//更改可用礼卡余额\r\n\t\t\t\t\t\tthis.$set(this.payInfo.memberAsset, \"cardAmount\", res.data.data.usefulAmount)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: res.data.message,\r\n\t\t\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tjudgeSurplusMoney() { //判断去除站内支付是否还有待支付余额 是否需要支付宝或微信进行支付\r\n\t\t\t\tlet stationMoney = 0 //站内总金额\r\n\t\t\t\tfor (let i = 0; i < this.chooseTypeList.length; i++) {\r\n\t\t\t\t\tswitch (this.chooseTypeList[i]) {\r\n\t\t\t\t\t\tcase \"账户余额\":\r\n\t\t\t\t\t\t\tstationMoney += this.payInfo.memberAsset.balanceUseMoney\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase \"礼卡\":\r\n\t\t\t\t\t\t\tstationMoney += this.payInfo.memberAsset.cardUseMoney\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!this.payInfo.payedSummary) {\r\n\t\t\t\t\tthis.surplusMoney = this.payInfo.orderAmount - stationMoney;\r\n\t\t\t\t}\r\n\t\t\t\treturn this.surplusMoney\r\n\t\t\t},\r\n\t\t\tjudegChooseOther() { //当余额不足支付 或 不勾选余额支付   判断应该选中支付宝还是微信\r\n\t\t\t\tif (this.isWxFlag) {\r\n\t\t\t\t\tif (this.judgeTypeIsExistence(\"微信\") != -1 && this.judgeSurplusMoney() <= 0) {\r\n\t\t\t\t\t\tthis.chooseTypeList.splice(this.judgeTypeIsExistence(\"微信\"), 1)\r\n\t\t\t\t\t} else if (this.judgeSurplusMoney() > 0 && this.judgeTypeIsExistence(\"微信\") == -1) {\r\n\t\t\t\t\t\tthis.chooseTypeList.push(\"微信\")\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t// 只有不是小程序会执行该代码\r\n\t\t\t\t// #ifndef MP-WEIXIN\r\n\t\t\t\tif (!this.isWxFlag) { //在普通浏览器中\r\n\t\t\t\t\tif (this.judgeTypeIsExistence(\"支付宝\") != -1 && this.judgeSurplusMoney() <= 0) {\r\n\t\t\t\t\t\tthis.chooseTypeList.splice(this.judgeTypeIsExistence(\"支付宝\"), 1)\r\n\t\t\t\t\t} else if (this.judgeSurplusMoney() > 0 && this.judgeTypeIsExistence(\"支付宝\") == -1) {\r\n\t\t\t\t\t\tthis.chooseTypeList.push(\"支付宝\")\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\t\t\tasync accountChange() { //账户余额取消/选中触发\r\n\t\t\t\tif (this.judgeTypeIsExistence(\"账户余额\") != -1) {\r\n\t\t\t\t\tthis.chooseTypeList.splice(this.judgeTypeIsExistence(\"账户余额\"), 1);\r\n\t\t\t\t\tthis.payInfo.memberAsset.balanceUseMoney = 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.chooseTypeList.push(\"账户余额\");\r\n\t\t\t\t\tthis.payInfo.memberAsset.balanceUseMoney = this.payInfo.memberAsset.balance\r\n\t\t\t\t}\r\n\t\t\t\tawait this.defaultCards();\r\n\t\t\t\tthis.judegChooseOther();\r\n\t\t\t\tif (this.judgeTypeIsExistence(\"账户余额\") == -1) {\r\n\t\t\t\t\tif (!this.payInfo.memberAsset.cardUseMoney) {\r\n\t\t\t\t\t\tthis.payInfo.memberAsset.balance = this.oldBalance\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.payInfo.memberAsset.balance = (this.surplusMoney < this.oldBalance ? this.surplusMoney : this.oldBalance)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync giftChange() { //礼卡余额取消/选中触发\r\n\t\t\t\tif (this.judgeTypeIsExistence(\"礼卡\") != -1) {\r\n\t\t\t\t\tthis.chooseTypeList.splice(this.judgeTypeIsExistence(\"礼卡\"), 1);\r\n\t\t\t\t\tthis.payInfo.memberAsset.cardUseMoney = 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.chooseTypeList.push(\"礼卡\");\r\n\t\t\t\t\tthis.payInfo.memberAsset.cardUseMoney = this.payInfo.memberAsset.cardAmount\r\n\t\t\t\t}\r\n\t\t\t\tawait this.defaultCards();\r\n\t\t\t\tthis.judegChooseOther() //计算剩余金额  如果余额没有选中的话  去更新账户余额\r\n\t\t\t\tif (this.judgeTypeIsExistence(\"账户余额\") == -1) {\r\n\t\t\t\t\tthis.payInfo.memberAsset.balance = (this.oldBalance - this.surplusMoney > 0 ? this.surplusMoney : this.oldBalance)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\toutsideStationChange(type) { //站外支付取消选中时触发\r\n\t\t\t\tlet index = this.judgeTypeIsExistence(type)\r\n\t\t\t\tif (index != \"-1\" && this.judgeIsExistence() == 2) { //已经勾选 要取消  两者都存在时可以取消\r\n\t\t\t\t\tif (type == \"微信\") {\r\n\t\t\t\t\t\tthis.chooseTypeList.splice(index, 1, \"支付宝\")\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.chooseTypeList.splice(index, 1, \"微信\")\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcardAmountChange(params) { //礼卡列表选中变化时触发\r\n\t\t\t\tthis.cardInfo = params;\r\n\t\t\t\t// 选中的礼卡支付金额\r\n\t\t\t\tthis.$set(this.payInfo.memberAsset, \"cardUseMoney\", params.selectedAmount);\r\n\t\t\t\tif (this.judgeTypeIsExistence(\"礼卡\") == -1) {\r\n\t\t\t\t\tthis.chooseTypeList.push(\"礼卡\")\r\n\t\t\t\t} else if (!this.payInfo.memberAsset.cardUseMoney && this.judgeTypeIsExistence(\"礼卡\") != -1) {\r\n\t\t\t\t\tthis.chooseTypeList.splice(this.judgeTypeIsExistence(\"礼卡\"), 1)\r\n\t\t\t\t}\r\n\t\t\t\tthis.judegChooseOther();\r\n\t\t\t\t// 可用金额\r\n\t\t\t\tthis.payInfo.memberAsset.balance = (this.oldBalance - this.surplusMoney > 0 ? this.surplusMoney : this.oldBalance)\r\n\t\t\t},\r\n\t\t\tjudgeTypeIsExistence(type) { //判断类型是否选中 存在返回下标\r\n\t\t\t\tlet index = this.chooseTypeList.findIndex(data => {\r\n\t\t\t\t\treturn data == type\r\n\t\t\t\t})\r\n\t\t\t\treturn index\r\n\t\t\t},\r\n\t\t\tjudgeIsExistence() { //判断支付宝和微信是否同时存在\r\n\t\t\t\tlet isExistence = 0; //存在一个加1  为2时说明支付宝和微信都存在  用来判断是否可以取消某个站外支付\r\n\t\t\t\tif (this.isWxFlag) { //微信存在\r\n\t\t\t\t\tisExistence++\r\n\t\t\t\t}\r\n\t\t\t\t// #ifndef MP-WEIXIN\r\n\t\t\t\tif (!this.isWxFlag) { //支付宝存在\r\n\t\t\t\t\tisExistence++\r\n\t\t\t\t}\r\n\t\t\t\t// #endif\r\n\t\t\t\treturn isExistence\r\n\t\t\t},\r\n\t\t\topenPswPopup() { //打开支付密码弹窗\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tif (this.payInfo.orderSummary.scorePayedAmount || this.judgeTypeIsExistence(\"礼卡\") != \"-1\" || this.judgeTypeIsExistence(\r\n\t\t\t\t\t\t\"账户余额\") != \"-1\") {\n\t\t\t\t\t\t\tconsole.log(this.payInfo)\r\n\t\t\t\t\tif (this.payInfo.riskCheck && this.payInfo.riskCheck.riskLevel == 'MID') {\r\n\t\t\t\t\t\tthis.$refs.verificationCode.openVerificationCode()\r\n\t\t\t\t\t} else if (this.payInfo.riskCheck && this.payInfo.riskCheck.riskLevel == 'LOW' && this.payInfo.riskCheck.firstAddrMobile && !this.payInfo.riskCheck\r\n\t\t\t\t\t\t.monthNewMember) {\r\n\t\t\t\t\t\tif (this.payInfo.riskCheck && this.payInfo.riskCheck.unsafeAmt < (this.payInfo.memberAsset.cardUseMoney + this.payInfo.memberAsset.scorePayedAmount +\r\n\t\t\t\t\t\t\t\tthis.payInfo.memberAsset.balanceUseMoney)) {\r\n\t\t\t\t\t\t\tthis.$refs.verificationCode.openVerificationCode()\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (this.payInfo.hasPayPwd) {\r\n\t\t\t\t\t\t\t\tthis.$refs.pswPopup.openPswPopup();\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.$refs.setPayPwd.openNoPswPopup()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (this.payInfo.hasPayPwd) {\r\n\t\t\t\t\t\t\tthis.$refs.pswPopup.openPswPopup();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.$refs.setPayPwd.openNoPswPopup()\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// 在微信小程序中 \r\n\t\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\t\t\tuni.login({\r\n\t\t\t\t\t\t\tsuccess(data) {\r\n\t\t\t\t\t\t\t\t_this.buildMiniPrepPaySign(data.code)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t\t\r\n\t\t\t\t\t// #ifdef H5\r\n\t\t\t\t\t\tthis.getH5Code()\r\n\t\t\t\t\t// #endif\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tbuildMiniPrepPaySign(code, payId) { //获取小程序支付相关信息\n\t\t\t\tlet orderType = \"good\"\n\t\t\t\tif(this.$Route.query.increase){\t//转增礼包\n\t\t\t\t\torderType = \"giftbag\"\n\t\t\t\t}else if(this.$Route.query.newtype>50){\t//会员礼包\n\t\t\t\t\torderType = \"newtype\"\n\t\t\t\t}\r\n\t\t\t\tpayMentApi.buildMiniPrepPaySign({\r\n\t\t\t\t\tcode: code,\r\n\t\t\t\t\torderPayId: payId ? payId : this.$Route.query.payId,\r\n\t\t\t\t\torderType: orderType\r\n\t\t\t\t}).then(res => {\r\n\t\t\t\t\tif (res.data.code == 200) {\r\n\t\t\t\t\t\tthis.requestpayment(res.data.data)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle:res.data.message,\r\n\t\t\t\t\t\t\ticon:\"none\"\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tbuildPrepPaySign(){\t//获取公众号支付信息\r\n\t\t\t\tpayMentApi.buildPrepPaySign({code:this.wxCode,orderPayId:this.$Route.query.payId,orderType:\"good\"}).then(res=>{\r\n\t\t\t\t\tif(res.data.code==200){\r\n\t\t\t\t\t\tthis.requestH5Payment(res.data.data)\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle:res.data.message,\r\n\t\t\t\t\t\t\ticon:\"none\"\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\trequestpayment(params) { //小程序支付\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tuni.requestPayment({\r\n\t\t\t\t\tprovider: \"payment\",\r\n\t\t\t\t\ttimeStamp: params.timeStamp,\r\n\t\t\t\t\tnonceStr: params.nonceStr,\r\n\t\t\t\t\tpackage: params.package,\r\n\t\t\t\t\tpaySign: params.paySign,\r\n\t\t\t\t\tsignType: params.signType,\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t_this.payCallBack(true)\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: function(res) {\r\n\t\t\t\t\t\t_this.payCallBack(false)\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\trequestH5Payment(params){\t//微信公众号支付\r\n\t\t\t\tif (typeof WeixinJSBridge == \"undefined\"){\r\n\t\t\t\t   if( document.addEventListener ){\r\n\t\t\t\t       document.addEventListener('WeixinJSBridgeReady', this.WeixinJSBridgeH5, false);\r\n\t\t\t\t   }else if (document.attachEvent){\r\n\t\t\t\t       document.attachEvent('WeixinJSBridgeReady', this.WeixinJSBridgeH5); \r\n\t\t\t\t       document.attachEvent('onWeixinJSBridgeReady', this.WeixinJSBridgeH5);\r\n\t\t\t\t   }\r\n\t\t\t\t}else{\r\n\t\t\t\t   this.WeixinJSBridgeH5(params);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tWeixinJSBridgeH5(params){\r\n\t\t\t\tlet _this=this;\r\n\t\t\t\tWeixinJSBridge.invoke(\r\n\t\t\t\t\t'getBrandWCPayRequest', {\r\n\t\t\t\t\t\t\"appId\":params.appId,     //公众号名称，由商户传入     \r\n\t\t\t\t\t\t\"timeStamp\":params.timeStamp,         //时间戳，自1970年以来的秒数     \r\n\t\t\t\t\t\t\"nonceStr\":params.nonceStr, //随机串     \r\n\t\t\t\t\t\t\"package\":params.package,     \r\n\t\t\t\t\t\t\"signType\":params.signType,         //微信签名方式：     \r\n\t\t\t\t\t\t\"paySign\":params.paySign //微信签名 \r\n\t\t\t\t\t},\r\n\t\t\t\t\tfunction(res){\r\n\t\t\t\t\t\tif (res.err_msg == \"get_brand_wcpay_request:ok\") {\r\n\t\t\t\t\t\t\t_this.payCallBack(true)\r\n\t\t\t\t\t\t} else if (res.err_msg == \"get_brand_wcpay_request:cancel\") {\r\n\t\t\t\t\t\t\t_this.payCallBack(false)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t_this.payCallBack(false)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t); \r\n\t\t\t},\r\n\t\t\tpayCallBack(flag){\t //支付成功或失败的回调\r\n\t\t\t\tif(flag){\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: \"支付成功\",\r\n\t\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.$Router.replace({\r\n\t\t\t\t\t\tpath: \"/pages/payment/index\",\r\n\t\t\t\t\t\tquery:{\r\n\t\t\t\t\t\t\tpayId:this.$Route.query.payId,\r\n\t\t\t\t\t\t\tnewtype:this.$Route.query.newtype,\n\t\t\t\t\t\t\tincrease:this.$Route.query.increase || \"\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}else{\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: \"已取消支付,正在前往订单页\",\r\n\t\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t\t})\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.$Router.replace({\r\n\t\t\t\t\t\t\tpath: \"/pages/order/index\",\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}, 500)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetH5Code(){\t//获取公众号code\r\n\t\t\t\twechatApi.wxPubAppId().then(res=>{\r\n\t\t\t\t\tif(res.data.code==200){\r\n\t\t\t\t\t\tlet urls = 'https://' + location.host + location.pathname+'?payId='+this.$Route.query.payId;\r\n\t\t\t\t\t\tlocation.href ='https://open.weixin.qq.com/connect/oauth2/authorize?appid='+res.data.data + '&redirect_uri=' + encodeURIComponent(urls) +'&response_type=code&scope=snsapi_userinfo';\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle:res.data.message,\r\n\t\t\t\t\t\t\ticon:\"none\"\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\topenForgetPopup() { //打开忘记支付密码弹窗\r\n\t\t\t\tthis.$refs.forgetPayPsw.openForgetPopup();\r\n\t\t\t},\r\n\t\t\tsetSubmitPsw(password) { //子集修改密码/重置密码/输入密码后点击确定触发  赋值支付密码\r\n\t\t\t\tthis.submitParams.password = password;\r\n\t\t\t\tthis.submit()\r\n\t\t\t},\r\n\t\t\tcodeSubmit(code) { //用户安全等级过低时 触发验证码  点击确定  提交订单\r\n\t\t\t\tthis.$set(this.submitParams, \"code\", code);\r\n\t\t\t\tthis.submit()\r\n\t\t\t},\r\n\t\t\tsubmit() { //提交支付\r\n\t\t\t\tthis.submitParams = {\r\n\t\t\t\t\tbalance: this.payInfo.memberAsset.balanceUseMoney ? this.payInfo.memberAsset.balanceUseMoney : 0,\r\n\t\t\t\t\tpassword: this.submitParams.password,\r\n\t\t\t\t\tpayId: this.$Route.query.payId,\r\n\t\t\t\t\tscore: this.payInfo.orderSummary.scorePayedAmount,\r\n\t\t\t\t\tthirdPayAmount: Number(this.surplusMoney).toFixed(2),\r\n\t\t\t\t\tthirdPayMethod: this.chooseTypeList.indexOf(\"支付宝\") != \"1\" ? \"alipay\" : \"wxpay\",\r\n\t\t\t\t\tcode: this.submitParams.code,\r\n\t\t\t\t\tcardAmount: this.payInfo.memberAsset.cardUseMoney ? this.payInfo.memberAsset.cardUseMoney : 0\r\n\t\t\t\t}\r\n\t\t\t\ttradeApi.submitPay(this.submitParams).then(res => {\r\n\t\t\t\t\tif (res.data.code == 200) {\r\n\t\t\t\t\t\tthis.$refs.verificationCode.closeVerificationCode();\r\n\t\t\t\t\t\tif (this.judgeTypeIsExistence(\"微信\") != \"-1\") {\r\n\t\t\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\t\t\ttitle: '正在前往微信支付',\r\n\t\t\t\t\t\t\t\tmask: false\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tuni.login({\r\n\t\t\t\t\t\t\t\tsuccess: (data) => {\r\n\t\t\t\t\t\t\t\t\tthis.buildMiniPrepPaySign(data.code, res.data.data)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.payCallBack(true)\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: res.data.message,\r\n\t\t\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\topenGiftCardPopup() { //打开礼卡弹窗\r\n\t\t\t\tif (this.cardInfo.usableCards && this.cardInfo.usableCards.length) {\r\n\t\t\t\t\tthis.$refs.giftCard.openGiftCardPopup()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t\tonLoad(option) {\r\n\t\t\t// #ifdef H5\r\n\t\t\tlet ua = navigator.userAgent.toLowerCase();\r\n\t\t\tif (ua.match(/MicroMessenger/i) == \"micromessenger\") {\r\n\t\t\t\tthis.isWxFlag = true //在微信浏览器中\r\n\t\t\t} else {\r\n\t\t\t\tthis.isWxFlag = false //不在微信浏览器中\r\n\t\t\t}\r\n\t\t\t//#endif\r\n\t\t\t/*微信小程序*/\r\n\t\t\t//#ifdef MP-WEIXIN\r\n\t\t\tthis.isWxFlag = 1\r\n\t\t\tthis.fmagentInit()\r\n\t\t\t//#endif\r\n\t\t\tthis.submitParams.payId = this.$Route.query.payId;\r\n\t\t\tthis.summary();\r\n\t\t\tif(option.code){\r\n\t\t\t\tthis.wxCode = option.code;\r\n\t\t\t\tthis.buildPrepPaySign()\r\n\t\t\t}\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\tthis.zhuge.track(\"订单收银台-落地页\")\r\n\t\t},\r\n\t\tcomponents: {\r\n\t\t\tsetPayPwd,\r\n\t\t\tforgetPayPsw,\r\n\t\t\tpswPopup,\r\n\t\t\tverificationCode,\r\n\t\t\tcardList\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t.commonPageTitle {\r\n\t\t/* #ifndef MP-WEIXIN */\r\n\t\tpadding-top: 88rpx;\r\n\t\t/* #endif */\r\n\t\tmin-height: 100vh;\r\n\t\tbackground-color: #FFFFFF;\r\n\t}\r\n\t.orderPrice {\r\n\t\twidth: 100%;\r\n\t\theight: 80rpx;\r\n\t\ttext-align: center;\r\n\t\tline-height: 80rpx;\r\n\t\tposition: relative;\r\n\t\tfont-size: 34rpx;\r\n\t\t/* #ifdef MP-WEIXIN */\r\n\t\tmargin-top: 40rpx;\r\n\t\t/* #endif */\r\n\t}\r\n\r\n\t.orderAmount {\r\n\t\tcolor: #FF1558;\r\n\t}\r\n\r\n\t.orderDetailsBtn {\r\n\t\tposition: absolute;\r\n\t\tright: 24rpx;\r\n\t\ttop: 0;\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #666;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.orderDetailsBtn text {\r\n\t\tdisplay: inline-block;\r\n\t\twidth: 40rpx;\r\n\t\theight: 80rpx;\r\n\t\tbackground: url(http://beifa-mall.oss-cn-shanghai.aliyuncs.com/appletsImages/coupon_cannotusearrow@2x.png) no-repeat 50%;\r\n\t\tbackground-size: 20rpx 10rpx;\r\n\t}\r\n\r\n\t.orderPriceMain {\r\n\t\twidth: 100%;\r\n\t\tpadding: 24rpx;\r\n\t\tbackground-color: #FFFFFF;\r\n\t}\r\n\r\n\t.everyRow {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #999999;\r\n\t\tmargin: 5rpx 0;\r\n\t}\r\n\r\n\t.myWalletHead {\r\n\t\tmargin-top: 48rpx;\r\n\t\tpadding: 24rpx;\r\n\t\twidth: 100%;\r\n\t\tfont-size: 34rpx;\r\n\t\tcolor: #333333;\r\n\t\tfont-weight: 700;\r\n\t}\r\n\r\n\t.myWalletInfo {\r\n\t\tdisplay: flex;\r\n\t\tpadding: 30rpx 24rpx;\r\n\t\talign-items: center;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.walletIcon,\r\n\t.alipayIcon,\r\n\t.weixinIcon {\r\n\t\twidth: 60rpx;\r\n\t\theight: 80rpx;\r\n\t\tbackground: url(http://beifa-mall.oss-cn-shanghai.aliyuncs.com/appletsImages/icon_qb.png) no-repeat 50%;\r\n\t\tbackground-size: 50rpx 50rpx;\r\n\t}\r\n\r\n\t.alipayIcon {\r\n\t\tbackground: url(http://beifa-mall.oss-cn-shanghai.aliyuncs.com/appletsImages/icon_zhi.png) no-repeat 50%;\r\n\t\tbackground-size: 50rpx 50rpx;\r\n\t}\r\n\r\n\t.weixinIcon {\r\n\t\tbackground: url(http://beifa-mall.oss-cn-shanghai.aliyuncs.com/appletsImages/icon_weixin.png) no-repeat 50%;\r\n\t\tbackground-size: 50rpx 50rpx;\r\n\t}\r\n\r\n\t.icon_m {\r\n\t\tbackground: url(http://beifa-mall.oss-cn-shanghai.aliyuncs.com/appletsImages/icon_m.png) no-repeat 50%;\r\n\t\tbackground-size: 50rpx 50rpx;\r\n\t}\r\n\r\n\t.payText {\r\n\t\tflex: 1;\r\n\t\tline-height: 80rpx;\r\n\t\tpadding: 0 18rpx;\r\n\t}\r\n\r\n\t.walletText {\r\n\t\tflex: 1;\r\n\t\tpadding: 0 20rpx;\r\n\t}\r\n\r\n\t.walletType {\r\n\t\theight: 40rpx;\r\n\t\tline-height: 40rpx;\r\n\t\tcolor: #333333;\r\n\t}\r\n\r\n\t.walletPrice {\r\n\t\tcolor: #999;\r\n\t\tfont-size: 24rpx;\r\n\t\tline-height: 40rpx;\r\n\t}\r\n\r\n\t.surePayBtn {\r\n\t\twidth: 100%;\r\n\t\theight: 100rpx;\r\n\t\tbackground-color: #FF1558;\r\n\t\tcolor: #FFFFFF;\r\n\t\tposition: fixed;\r\n\t\tbottom: calc(0rpx + constant(safe-area-inset-bottom));\r\n\t\tbottom: calc(0rpx + env(safe-area-inset-bottom));\r\n\t\tleft: 0;\r\n\t\ttext-align: center;\r\n\t\tline-height: 100rpx;\r\n\t}\r\n\r\n\r\n\t.payPrice {\r\n\t\tline-height: 80rpx;\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #333333;\r\n\t}\r\n\r\n\t.payChooseBtn {\r\n\t\twidth: 36rpx;\r\n\t\theight: 36rpx;\r\n\t\tbackground: url(http://beifa-mall.oss-cn-shanghai.aliyuncs.com/appletsImages/oval_3copy4@2x.png) no-repeat 50%;\r\n\t\tbackground-size: 36rpx 36rpx;\r\n\t\tmargin-left: 20rpx;\r\n\t}\r\n\r\n\t.payChooseBtn.active {\r\n\t\tbackground: url(http://beifa-mall.oss-cn-shanghai.aliyuncs.com/appletsImages/subr.png) no-repeat 50%;\r\n\t\tbackground-size: 36rpx 36rpx;\r\n\t}\r\n\r\n\t.payType {\r\n\t\twidth: 100%;\r\n\t\tdisplay: flex;\r\n\t\tpadding: 30rpx 24rpx;\r\n\t\talign-items: center;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.mask {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tbackground-color: rgba(255, 255, 255, 0.5);\r\n\t}\r\n\t\r\n</style>\r\n","import mod from \"-!../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=32f2f1fc&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=32f2f1fc&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1639368367661\n      var cssReload = require(\"/Users/guojunqiang/Documents/project-bf/new-mall-mobile/node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}