<view class="{{['page settlement data-v-60591ae5',memberType!=4&&memberPriceInfo.type&&orderSummaryInfo.achievementAmount!=0?'active':'']}}"><default-title vue-id="aa6a7a7e-1" dto="{{({title:'填写订单',bottomColor:'#E6E6E6'})}}" class="data-v-60591ae5" bind:__l="__l"></default-title><view class="settlementAddress data-v-60591ae5"><block wx:if="{{orderInfo.address}}"><view data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" bindtap="__e" class="data-v-60591ae5"><view class="settlementTitle data-v-60591ae5"><text class="data-v-60591ae5">{{orderInfo.address.name}}</text><text class="telephone data-v-60591ae5">{{orderInfo.address.telephone}}</text></view><block wx:if="{{orderInfo.address}}"><view class="addressMain data-v-60591ae5">{{''+(orderInfo.address.provinceName+orderInfo.address.cityName+orderInfo.address.districtName+(orderInfo.address.townName?orderInfo.address.townName:"")+orderInfo.address.address)+''}}</view></block></view></block><block wx:if="{{!orderInfo.address}}"><view data-event-opts="{{[['tap',[['e1',['$event']]]]]}}" class="nullAddress data-v-60591ae5" bindtap="__e">请填写收货地址</view></block><view class="arrow data-v-60591ae5"></view></view><view class="settlementLine data-v-60591ae5"></view><block wx:if="{{orderInfo.address&&orderInfo.address.checkStatus=='2'}}"><view class="addressChange data-v-60591ae5">*由于邮政地址升级，请填写街道地址</view></block><block wx:for="{{$root.l1}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="orderMain data-v-60591ae5"><view class="shopName data-v-60591ae5">{{''+item.$orig.storeName+''}}</view><block wx:for="{{item.l0}}" wx:for-item="v" wx:for-index="i" wx:key="goodsId"><view class="data-v-60591ae5"><view class="goodsCont data-v-60591ae5"><image src="{{imgBaseUrls+v.$orig.goodsImg}}" mode class="data-v-60591ae5"></image><view class="goodsInfo data-v-60591ae5"><view class="goodsText ellipsis-two data-v-60591ae5">{{''+v.$orig.goodsName+''}}</view><view class="goodSpce data-v-60591ae5">{{''+v.$orig.saleFieldValue+''}}</view><view class="goodsPrice data-v-60591ae5"><text class="data-v-60591ae5">{{"¥"+v.$orig.originPrice}}</text><view class="{{['goodsNum data-v-60591ae5',limitSettle.isCart?'active':'']}}"><block wx:if="{{!limitSettle.isCart}}"><block class="data-v-60591ae5"><view data-event-opts="{{[['tap',[['goodsNumChange',['$0',false],[[['orderInfo.stores','',index],['goodsList','goodsId',v.$orig.goodsId]]]]]]]}}" class="jian data-v-60591ae5" bindtap="__e">-</view><input type="number" data-event-opts="{{[['blur',[['goodsNumBlur',['$event','$0'],[[['orderInfo.stores','',index],['goodsList','goodsId',v.$orig.goodsId]]]]]],['input',[['__set_model',['$0','goodsNum','$event',[]],[[['orderInfo.stores','',index],['goodsList','goodsId',v.$orig.goodsId]]]]]]]}}" value="{{v.$orig.goodsNum}}" bindblur="__e" bindinput="__e" class="data-v-60591ae5"/><view data-event-opts="{{[['tap',[['goodsNumChange',['$0',true],[[['orderInfo.stores','',index],['goodsList','goodsId',v.$orig.goodsId]]]]]]]}}" class="jia data-v-60591ae5" bindtap="__e">+</view></block></block><block wx:else><block class="data-v-60591ae5">{{'x'+v.$orig.goodsNum+''}}</block></block></view></view></view></view><block wx:if="{{v.$orig.presaleFlag}}"><view class="deliveryTime data-v-60591ae5"><image src="{{imgBaseUrls+'appletsImages/openBookingIcon.png'}}" mode class="data-v-60591ae5"></image>{{'发货时间：'+v.g0+" ~ "+v.g1+''}}</view></block><block wx:if="{{v.$orig.separatePromotion}}"><view class="separatePromotion data-v-60591ae5"><text class="data-v-60591ae5">{{v.$orig.separatePromotion.name}}</text><text class="marking_plus data-v-60591ae5">{{v.$orig.separatePromotion.typeName}}</text></view></block><view class="data-v-60591ae5"><block wx:for="{{v.$orig.promotions}}" wx:for-item="l" wx:for-index="o" wx:key="o"><block wx:if="{{l.typeCode==19}}"><view class="fmGoodsMsg data-v-60591ae5"><text class="promotionsActivityBox data-v-60591ae5">{{l.typeName}}</text></view></block><block wx:else><block wx:for="{{v.$orig.promotions}}" wx:for-item="l" wx:for-index="o" wx:key="o"><view class="fmGoodsMsg data-v-60591ae5">{{''+(l.name?l.name:"")+''}}<text class="activityBox data-v-60591ae5">{{l.typeName}}</text></view></block></block></block></view></view></block><view class="fmGoodsMsg data-v-60591ae5"><text class="data-v-60591ae5">运费</text><text class="colorChange data-v-60591ae5">{{freightData[item.$orig.storeId]?"￥"+freightData[item.$orig.storeId]:"包邮"}}</text></view><block wx:if="{{storePromotion[item.$orig.storeId]&&storePromotion[item.$orig.storeId].length}}"><store-promotion-view vue-id="{{'aa6a7a7e-2-'+index}}" choosePromotionId="{{couponParams[item.$orig.storeId].promotionId}}" storePromotion="{{storePromotion}}" storeId="{{item.$orig.storeId}}" storeName="{{item.$orig.storeName}}" data-event-opts="{{[['^promotionChange',[['promotionCouponChange']]]]}}" bind:promotionChange="__e" class="data-v-60591ae5" bind:__l="__l"></store-promotion-view></block><block wx:if="{{storeCouponsInfo[item.$orig.storeId]&&storeCouponsInfo[item.$orig.storeId].availableList&&storeCouponsInfo[item.$orig.storeId].availableList.length}}"><store-coupons vue-id="{{'aa6a7a7e-3-'+index}}" storeCouponsInfo="{{storeCouponsInfo}}" chooseStoreId="{{freightParams[item.$orig.storeId].couponId}}" storeId="{{item.$orig.storeId}}" storeName="{{item.$orig.storeName}}" data-event-opts="{{[['^couponChange',[['storeCouponChange']]]]}}" bind:couponChange="__e" class="data-v-60591ae5" bind:__l="__l"></store-coupons></block><view class="fmGoodsMsg data-v-60591ae5">留言<input type="text" maxlength="40" placeholder="选填,限40字以内" data-event-opts="{{[['input',[['__set_model',['$0','orderMessage','$event',[]],['orderMessage.'+item.$orig.storeId+'']]]]]}}" value="{{orderMessage[item.$orig.storeId].orderMessage}}" bindinput="__e" class="data-v-60591ae5"/></view><view class="fmGoodsMsg data-v-60591ae5"><view class="data-v-60591ae5"></view><view class="price data-v-60591ae5">{{"共"+item.$orig.goodsNum+"件商品 合计："}}<text class="priceSymbol data-v-60591ae5">￥</text><text class="symbolPrice data-v-60591ae5">{{storeAmountData[item.$orig.storeId]}}</text>{{'(含运费¥'+freightData[item.$orig.storeId]+")"}}</view></view></view></block><block wx:if="{{platforCouponsInfo.availableList&&platforCouponsInfo.availableList.length}}"><platform-coupons vue-id="aa6a7a7e-4" platforCouponsInfo="{{platforCouponsInfo}}" choosePlatfromId="{{orderSummaryParams.platformPromotionId}}" data-event-opts="{{[['^couponChange',[['plateformCouponChange']]]]}}" bind:couponChange="__e" class="data-v-60591ae5" bind:__l="__l"></platform-coupons></block><block wx:if="{{memberType==4}}"><view class="integralMain  data-v-60591ae5"><text class="partnerPref data-v-60591ae5">合伙人优惠</text><text class="intergalInfo partnerPrefNum data-v-60591ae5">{{"-¥"+orderSummaryInfo.distributorDiscount}}</text></view></block><view class="integralMain data-v-60591ae5"><text class="data-v-60591ae5">使用库豆</text><block wx:if="{{orderGoldCount.accountGold>0&&orderGoldCount.canUseGold}}"><text class="intergalInfo data-v-60591ae5">{{"库豆"+orderGoldCount.accountGold+",本次可抵用￥"+orderGoldCount.canUseGold}}</text></block><block wx:if="{{orderGoldCount.accountGold>0&&!orderGoldCount.canUseGold}}"><text class="intergalInfo data-v-60591ae5">购买的商品不支持使用库豆支付</text></block><block wx:if="{{orderGoldCount.accountGold<=0}}"><text class="intergalInfo data-v-60591ae5">本次无可用库豆</text></block><view class="intergalBtn data-v-60591ae5"><switch style="transform:scale(0.7,0.7);" disabled="{{orderGoldCount.canUseGold<=0}}" checked="{{deductionFlag.gold}}" color="#FF1558" data-event-opts="{{[['change',[['goldChange',['$event']]]]]}}" bindchange="__e" class="data-v-60591ae5"></switch></view></view><view class="integralMain scoreBox data-v-60591ae5"><text class="data-v-60591ae5">使用积分</text><block wx:if="{{orderScoreCount.usefulScoreNum>0}}"><text class="intergalInfo data-v-60591ae5">{{"本次可用"+orderScoreCount.usefulScoreNum+",本次可抵用￥"+orderScoreCount.score}}</text></block><block wx:if="{{orderScoreCount.usefulScoreNum<=0}}"><text class="intergalInfo data-v-60591ae5">本次无可用积分</text></block><view class="intergalBtn data-v-60591ae5"><switch style="transform:scale(0.7,0.7);" disabled="{{orderScoreCount.score<=0}}" checked="{{deductionFlag.score}}" color="#FF1558" data-event-opts="{{[['change',[['scoreChange',['$event']]]]]}}" bindchange="__e" class="data-v-60591ae5"></switch></view></view><view class="deduction data-v-60591ae5"><text class="data-v-60591ae5">商品金额</text><text class="data-v-60591ae5">{{"￥"+orderSummaryInfo.goodsFinalAmount}}</text></view><block wx:if="{{orderSummaryInfo.freightAmount>0}}"><view class="deduction data-v-60591ae5"><text class="data-v-60591ae5">运费</text><text class="data-v-60591ae5">{{"￥"+orderSummaryInfo.freightAmount}}</text></view></block><block wx:if="{{orderSummaryInfo.couponAmount>0}}"><view class="deduction data-v-60591ae5"><text class="data-v-60591ae5">优惠券</text><text class="data-v-60591ae5">{{"-￥"+orderSummaryInfo.couponAmount}}</text></view></block><block wx:if="{{orderSummaryInfo.socreAmount>0}}"><view class="deduction data-v-60591ae5"><text class="data-v-60591ae5">积分抵扣</text><text class="data-v-60591ae5">{{"-￥"+orderSummaryInfo.socreAmount}}</text></view></block><block wx:if="{{orderSummaryInfo.goldAmount>0}}"><view class="deduction data-v-60591ae5"><text class="data-v-60591ae5">库豆抵扣</text><text class="data-v-60591ae5">{{"-￥"+orderSummaryInfo.goldAmount}}</text></view></block><block wx:if="{{memberType==4}}"><view class="deduction performance data-v-60591ae5"><text class="data-v-60591ae5">本单商品计有效业绩</text><text class="data-v-60591ae5">{{"￥"+orderSummaryInfo.performanceAmount}}</text></view></block><block wx:if="{{orderSummaryInfo.achievementAmount!=0&&memberType!=4&&(memberPriceInfo.type||memberPriceInfo.arriveType)}}"><view class="cartHint data-v-60591ae5"><view class="cartPrice data-v-60591ae5"><block wx:if="{{memberPriceInfo.arriveType}}"><view class="data-v-60591ae5">当前结算金额已满足<text class="data-v-60591ae5">{{memberPriceInfo.arriveType}}</text>升级条件</view></block><block wx:if="{{memberPriceInfo.price}}"><block class="data-v-60591ae5">还差<text class="memberGoodsPrice data-v-60591ae5">{{memberPriceInfo.price}}</text>元，</block></block><block wx:if="{{!memberPriceInfo.price}}"><block class="data-v-60591ae5">下单</block></block>{{'即可升级为'+memberPriceInfo.type+''}}</view><block wx:if="{{memberPriceInfo.price}}"><view data-event-opts="{{[['tap',[['gotoGoods',['$event']]]]]}}" class="goBuyBtn data-v-60591ae5" bindtap="__e">去凑单 ›</view></block></view></block><view class="goPayBox data-v-60591ae5"><view class="payText data-v-60591ae5">实付款：<text class="symbol data-v-60591ae5">￥</text><text class="payAmount data-v-60591ae5">{{orderSummaryInfo.payAmount?orderSummaryInfo.payAmount:0}}</text></view><view data-event-opts="{{[['tap',[['submitOrder',['$event']]]]]}}" class="submitBtn data-v-60591ae5" bindtap="__e">提交订单</view></view><psw-popup bind:openForgetPopup="__e" bind:submitPay="__e" vue-id="aa6a7a7e-5" data-ref="pswPopup" data-event-opts="{{[['^openForgetPopup',[['openForgetPopup']]],['^submitPay',[['setSubmitPsw']]]]}}" class="data-v-60591ae5 vue-ref" bind:__l="__l"></psw-popup><set-pay-pwd vue-id="aa6a7a7e-6" payInfo="{{orderInfo}}" data-ref="setPayPwd" data-event-opts="{{[['^openPswPopup',[['openPswPopup']]],['^submitPay',[['setSubmitPsw']]]]}}" bind:openPswPopup="__e" bind:submitPay="__e" class="data-v-60591ae5 vue-ref" bind:__l="__l"></set-pay-pwd><forget-pay-psw vue-id="aa6a7a7e-7" payInfo="{{orderInfo}}" data-ref="forgetPayPsw" data-event-opts="{{[['^openPswPopup',[['openPswPopup']]],['^submitPay',[['setSubmitPsw']]]]}}" bind:openPswPopup="__e" bind:submitPay="__e" class="data-v-60591ae5 vue-ref" bind:__l="__l"></forget-pay-psw><verification-code vue-id="aa6a7a7e-8" payInfo="{{orderInfo}}" data-ref="verificationCode" data-event-opts="{{[['^codeSubmit',[['codeSubmit']]]]}}" bind:codeSubmit="__e" class="data-v-60591ae5 vue-ref" bind:__l="__l"></verification-code><block wx:if="{{hideFMCanvas!=undefined&&!hideFMCanvas}}"><view class="data-v-60591ae5"><canvas style="margin-top:200rpx;" canvas-id="tdcanvas" class="data-v-60591ae5"></canvas></view></block></view>